tasks.whenTaskAdded { task ->
    if (task.name.startsWith("lint")) {
        if (task.name.toLowerCase().endsWith("release")) {
            task.doFirst {
                android.lintOptions.abortOnError = true
                android.lintOptions.warningsAsErrors true
                android.lintOptions.check 'NewApi', 'InlinedApi'
            }
        } else {
            task.doFirst {
                // move the baseline by deleting api/baseline.xml and AnkiDroid/baseline.xml then ./gradlew lintDebug
                android.lintOptions.baseline file('./lint-baseline.xml')
                android.lintOptions.abortOnError true
                android.lintOptions.checkAllWarnings true
                android.lintOptions.warningsAsErrors true
                android.lintOptions.showAll true
                android.lintOptions.textReport true
                android.lintOptions.textOutput 'stdout'
                android.lintOptions.htmlReport true
            }
        }
    }
}