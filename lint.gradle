tasks.whenTaskAdded { task ->
    if (task.name.startsWith("lint")) {
        if (task.name.toLowerCase().endsWith("release")) {
            task.doFirst {
                android.lintOptions.abortOnError = true
                android.lintOptions.warningsAsErrors true
                android.lintOptions.check 'NewApi', 'InlinedApi'
            }
        } else {
            task.doFirst {
                // move the baseline by deleting api/baseline.xml and AnkiDroid/baseline.xml then ./gradlew lintDebug
                android.lintOptions.baseline file('./lint-baseline.xml')
                // Disable 'SyntheticAccessor' -
                // See discussion on #6205 - we should fix these for performance, but low priority
                // compared to other more significant warnings.
                android.lintOptions.disable 'SyntheticAccessor'
                android.lintOptions.abortOnError true
                android.lintOptions.checkAllWarnings true
                android.lintOptions.warningsAsErrors true
                android.lintOptions.showAll true
                android.lintOptions.textReport true
                android.lintOptions.textOutput 'stdout'
                android.lintOptions.htmlReport true
            }
        }
    }
}